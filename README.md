# 트레이딩 봇

## 매매 전략 및 알고리즘

### 1. 핵심 지표
- **ADX (Average Directional Index)**
  - 추세 강도 측정
  - ADX ≥ 25: 강한 추세
  - ADX < 20: 약한 추세

- **RSI (Relative Strength Index)**
  - 과매수/과매도 구간 판단
  - RSI < 30: 과매도 구간
  - RSI > 70: 과매수 구간

- **MACD (Moving Average Convergence Divergence)**
  - 추세 전환 및 모멘텀 확인
  - MACD > Signal Line: 상승 추세
  - MACD < Signal Line: 하락 추세

### 2. 진입 조건
#### 롱 포지션 진입
1. ADX ≥ 25 (강한 추세)
2. RSI < 30 (과매도)
3. MACD 상향 돌파 (MACD > Signal Line)
4. MACD 히스토그램 양수

#### 숏 포지션 진입
1. ADX ≥ 25 (강한 추세)
2. RSI > 70 (과매수)
3. MACD 하향 돌파 (MACD < Signal Line)
4. MACD 히스토그램 음수

### 3. 청산 조건
#### 손절 (Stop Loss)
- 레버리지 기반 동적 손절 비율
- 기본 손절 비율: 1%
- 조정 공식: `sl_pct = base_sl_pct / sqrt(leverage)`
- 예시: 30x 레버리지 → 약 0.18% 손절

#### 익절 (Take Profit)
1. **초기 익절**
   - 기본 익절 비율: 3.0%
   - 레버리지 기반 조정: `tp_pct = base_tp_pct / sqrt(leverage)`

2. **트레일링 스탑**
   - 1차 청산: 최고 수익의 30% 하락 시 50% 청산
   - 2차 청산: 최고 수익의 60% 하락 시 잔여분 전량 청산

### 4. 포지션 사이징
- ATR 기반 동적 계산
- 계좌 잔고의 0.1%를 리스크로 설정
- 계산 공식: `position_size = risk_amount / (atr * 2)`
- 최대 포지션: 계좌 잔고의 95% 사용 가능

### 5. 레버리지 관리
- 기본 레버리지: 30x
- 범위: 10x ~ 75x
- 변동성 기반 동적 조정
- 계산 공식: `leverage = max(10, min(75, int((1.8/σ) + 5)))`
- σ(변동성) = ATR / 현재가격

### 6. 리스크 관리
- 단일 거래 최대 손실: 계좌의 1%
- 연속 손실 제한: 3회
- 최소 거래 간격: 5분
- 마진 부족 시 자동 포지션 크기 조정

### 7. 모니터링 및 알림
- 실시간 거래 상태 모니터링
- 텔레그램을 통한 거래 알림
- 주요 이벤트 로깅
  - 진입/청산
  - 수익/손실
  - 레버리지 변경
  - 포지션 크기 조정

### 8. 안전장치
- 주문 실패 시 자동 재시도
- 예외 상황 발생 시 안전한 청산
- 마진 부족 시 자동 포지션 크기 조정
- 연속 손실 시 거래 중단

## 사용 방법
1. 설정 파일(`config/settings.py`)에서 API 키 설정
2. 원하는 거래 쌍 설정
3. `python main.py` 실행

## 주의사항
- 실제 거래 전 반드시 테스트넷에서 테스트
- 레버리지 거래는 높은 리스크를 수반
- 시장 상황에 따라 전략 조정 필요